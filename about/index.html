<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Partial.js</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Partial.js는 함수형 자바스크립트를 더 많은 영역에서 사용하고자, 몇 가지 기능을 확장한 함수형 자바스크립트 라이브러리입니다. Partial.js는 부분 적용, 파이프라인, 불변적인 값 다루기, 가변적인 값 다루기, 템플릿 엔진, 비동기 제어, 이벤트 등의 기능을 제공하고 있습니다. 이 문서는 Partial.js의 주요 기능과 스타일을 소개합니다.">
<meta name="keywords" content="[object Object]">
<meta property="og:type" content="article">
<meta property="og:title" content="함수형 자바스크립트 라이브러리 Partial.js">
<meta property="og:url" content="https://marpple.github.io/partial.js/about/index.html">
<meta property="og:site_name" content="Partial.js">
<meta property="og:description" content="Partial.js는 함수형 자바스크립트를 더 많은 영역에서 사용하고자, 몇 가지 기능을 확장한 함수형 자바스크립트 라이브러리입니다. Partial.js는 부분 적용, 파이프라인, 불변적인 값 다루기, 가변적인 값 다루기, 템플릿 엔진, 비동기 제어, 이벤트 등의 기능을 제공하고 있습니다. 이 문서는 Partial.js의 주요 기능과 스타일을 소개합니다.">
<meta property="og:updated_time" content="2017-05-22T05:51:17.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="함수형 자바스크립트 라이브러리 Partial.js">
<meta name="twitter:description" content="Partial.js는 함수형 자바스크립트를 더 많은 영역에서 사용하고자, 몇 가지 기능을 확장한 함수형 자바스크립트 라이브러리입니다. Partial.js는 부분 적용, 파이프라인, 불변적인 값 다루기, 가변적인 값 다루기, 템플릿 엔진, 비동기 제어, 이벤트 등의 기능을 제공하고 있습니다. 이 문서는 Partial.js의 주요 기능과 스타일을 소개합니다.">
  
  
    <link rel="shortcut icon" href="/partial.js/css/images/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/partial.js/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer">
    <div id="header-title" class="inner">
      <a href="/partial.js/">
       
        <div id="logo">Partial.js</div>
       
      </a>
    </div>
    <div id="header-middle" class="inner"></div>
    <div id="header-menu" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/partial.js/">About</a>
        
          <a class="main-nav-link" href="/partial.js/docs">Docs</a>
        
          <a class="main-nav-link" href="https://github.com/marpple/partial.js">Github</a>
        
          <a class="main-nav-link" href="https://github.com/functionandjs/book">Book</a>
        
          <a class="main-nav-link" href="https://marpple.github.io/partial.py">Partial.py</a>
        
      </nav>
    </div>
  </div>
</header>
      <div id="body">
        <article id="about" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta"></div>
  <div class="article-inner">
    <div class="article-entry" itemprop="articleBody">
      <p>Partial.js는 함수형 자바스크립트를 더 많은 영역에서 사용하고자, 몇 가지 기능을 확장한 함수형 자바스크립트 라이브러리입니다. Partial.js는 부분 적용, 파이프라인, 불변적인 값 다루기, 가변적인 값 다루기, 템플릿 엔진, 비동기 제어, 이벤트 등의 기능을 제공하고 있습니다. 이 문서는 Partial.js의 주요 기능과 스타일을 소개합니다.</p>
<h2 id="설치하기"><a href="#설치하기" class="headerlink" title="설치하기"></a>설치하기</h2><h3 id="Partial-js-설치"><a href="#Partial-js-설치" class="headerlink" title="Partial.js 설치"></a>Partial.js 설치</h3><h5 id="다운로드는-아래에서"><a href="#다운로드는-아래에서" class="headerlink" title="다운로드는 아래에서:"></a>다운로드는 아래에서:</h5><p>소스코드는 <a href="https://github.com/marpple/partial.js" target="_blank" rel="external">https://github.com/marpple/partial.js</a> 에서 받을 수 있습니다. Partial.js는 48kb(compressed) 정도로 작지만 아주 쓸모 있습니다.</p>
<h5 id="브라우저에서"><a href="#브라우저에서" class="headerlink" title="브라우저에서:"></a>브라우저에서:</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"partial.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<h5 id="npm"><a href="#npm" class="headerlink" title="npm:"></a>npm:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm intall --save partial-js</div></pre></td></tr></table></figure>
<h5 id="Node-js에서"><a href="#Node-js에서" class="headerlink" title="Node.js에서:"></a>Node.js에서:</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> _ = <span class="built_in">require</span>(<span class="string">'partial-js'</span>);</div></pre></td></tr></table></figure>
<h3 id="다른-함수형-라이브러리와-함께-사용하기"><a href="#다른-함수형-라이브러리와-함께-사용하기" class="headerlink" title="다른 함수형 라이브러리와 함께 사용하기"></a>다른 함수형 라이브러리와 함께 사용하기</h3><p>함수형 자바스크립트 라이브러리들은 <code>_</code>를 네임스페이스로 사용하는 경우 많습니다. Partial.js 역시 <code>_</code>를 네임스페이스로 사용합니다. Partial.js는 Underscore.js나 Lodash의 주요 기능을 모두 가지고 있습니다. 해당 라이브러리를 함께 사용해야 한다면 Partial.js의 네임스페이스 관련 기능을 이용하면 됩니다. 기존 프로젝트에서 Lodash 등을 사용하고 있는데, Partial.js를 함께 사용하고 싶을 때 유용한 기능입니다.</p>
<h4 id="1-Node-js나-AMD의-경우-원래의-방식대로-네임스페이스를-원하는-대로-지정하면-됩니다"><a href="#1-Node-js나-AMD의-경우-원래의-방식대로-네임스페이스를-원하는-대로-지정하면-됩니다" class="headerlink" title="1. Node.js나 AMD의 경우 원래의 방식대로 네임스페이스를 원하는 대로 지정하면 됩니다."></a>1. Node.js나 AMD의 경우 원래의 방식대로 네임스페이스를 원하는 대로 지정하면 됩니다.</h4><h4 id="2-브라우저이고-AMD를-사용하지-않는다면-아래와-같은-순으로-불러오면-됩니다"><a href="#2-브라우저이고-AMD를-사용하지-않는다면-아래와-같은-순으로-불러오면-됩니다" class="headerlink" title="2. 브라우저이고 AMD를 사용하지 않는다면 아래와 같은 순으로 불러오면 됩니다."></a>2. 브라우저이고 AMD를 사용하지 않는다면 아래와 같은 순으로 불러오면 됩니다.</h4><p>아래처럼 불러오면 <code>_p.each</code>는 Partial.js의 <code>each</code>이고 <code>_.each</code>는 Lodash의 <code>each</code>가 됩니다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"partial.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"lodash.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>만일 <code>_p</code>가 맘에 들지 않으면 <code>window.p = _p;</code>처럼 원하는 대로 바꿔서 사용하면 됩니다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">window</span>.p = _p;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="2-부득이하게-불러오는-순서를-보장하지-못하는-경우라면-다음과-같이하면-됩니다"><a href="#2-부득이하게-불러오는-순서를-보장하지-못하는-경우라면-다음과-같이하면-됩니다" class="headerlink" title="2. 부득이하게 불러오는 순서를 보장하지 못하는 경우라면 다음과 같이하면 됩니다."></a>2. 부득이하게 불러오는 순서를 보장하지 못하는 경우라면 다음과 같이하면 됩니다.</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> lodash = _previous_underscore(); <span class="comment">// 다른 라이브러리의 _</span></div><div class="line"><span class="keyword">var</span> partial = _partial_namespace(); <span class="comment">// Partial.js의 _</span></div></pre></td></tr></table></figure>
<p>전역에 선언된 <code>_previous_underscore</code>함수를 실행하면 Partial.js가 불려지기전에 전역에 있던 <code>_</code>를 얻을 수 있고, 마찬가지로 전역에 선언된 <code>_partial_namespace</code> 함수를 실행하면 Partial.js의 <code>_</code>를 얻을 수 있습니다.</p>
<h2 id="더-나은-부분-적용-Partial-application"><a href="#더-나은-부분-적용-Partial-application" class="headerlink" title="더 나은 부분 적용 (Partial application)"></a>더 나은 부분 적용 (Partial application)</h2><p>Partial.js는 이름처럼 부분 적용(Partial application)을 중요하게 생각합니다. 기존의 <code>_.partial</code> 함수는 왼쪽에서부터만 인자를 적용해둘 수 있습니다. Partial.js의 <code>_.partial</code> 함수는 맨 오른쪽 인자나 맨 오른쪽에서 두 번째에만 인자를 적용해두는 것도 가능하며, 새로운 구분자인 <code>___</code>를 활용하여 중간 지점에 인자가 가변적으로 적용되도록 비워둘 수 있습니다.</p>
<h3 id="partial의-일반적-사용"><a href="#partial의-일반적-사용" class="headerlink" title="_.partial의 일반적 사용"></a>_.partial의 일반적 사용</h3><p><code>_.partial</code>을 실행하면서 인자 자리에 <code>_</code>를 넘기면 부분 적용할 인자를 건너띌 수 있습니다. <code>_</code>를 이용하면 원하는 곳에만 인자를 부분 적용해둘 수 있습니다. <code>_</code>가 있는 자리는 이후 실행시 채워집니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> pc = _.partial(<span class="built_in">console</span>.log, <span class="number">1</span>);</div><div class="line">pc(<span class="number">2</span>);</div><div class="line"><span class="comment">// 결과: 1 2</span></div><div class="line"><span class="comment">// 2 가 오른쪽으로 들어갑니다.</span></div><div class="line">pc(<span class="number">2</span>, <span class="number">3</span>);</div><div class="line"><span class="comment">// 결과: 1 2 3</span></div><div class="line"><span class="comment">// 2, 3이 오른쪽으로 들어갑니다.</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> pc = _.partial(<span class="built_in">console</span>.log, _, <span class="number">2</span>);</div><div class="line">pc(<span class="number">1</span>);</div><div class="line"><span class="comment">// 결과: 1 2</span></div><div class="line"><span class="comment">// 1이 왼쪽의 _ 자리에 들어갑니다.</span></div><div class="line">pc(<span class="number">1</span>, <span class="number">3</span>);</div><div class="line"><span class="comment">// 결과: 1 2 3</span></div><div class="line"><span class="comment">// 1이 왼쪽의 _ 자리에 들어가고 3이 오른쪽으로 들어갑니다.</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> pc = _.partial(<span class="built_in">console</span>.log, _, _, <span class="number">3</span>);</div><div class="line">pc(<span class="number">1</span>);</div><div class="line"><span class="comment">// 결과: 1 undefined 3</span></div><div class="line"><span class="comment">// 1이 왼쪽의 _ 자리에 들어가고 두 번째 _는 들어오지 않아 undefined가 됩니다.</span></div><div class="line">pc(<span class="number">1</span>, <span class="number">2</span>);</div><div class="line"><span class="comment">// 결과: 1 2 3</span></div><div class="line"><span class="comment">// 1과 2가 순서대로 _, _를 채웁니다.</span></div><div class="line">pc(<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>);</div><div class="line"><span class="comment">// 결과: 1 2 3 4</span></div><div class="line"><span class="comment">// 1과 2가 순서대로 _, _를 채우고 3의 오른쪽으로 4가 들어갑니다.</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> pc = _.partial(<span class="built_in">console</span>.log, _, <span class="number">2</span>, _, <span class="number">4</span>);</div><div class="line">pc(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>);</div><div class="line"><span class="comment">// 결과: 1 2 3 4 5</span></div><div class="line"><span class="comment">// 1을 _ 자리에 채우고 2를 넘겨서 _에 3을 채우고 4의 오른쪽에 5가 들어갑니다.</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> pc = _.partial(<span class="built_in">console</span>.log, _, <span class="number">2</span>, _, _, <span class="number">5</span>);</div><div class="line">pc(<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>);</div><div class="line"><span class="comment">// 결과: 1 2 3 4 5 6</span></div><div class="line"><span class="comment">// 1을 _ 자리에 채우고 2를 넘겨서 _에 3을 채우고 다음 _에 4를 채우고 5의 오른쪽에 6이 들어갑니다.</span></div></pre></td></tr></table></figure>
<h3 id="오른쪽에서부터-인자-적용해두기"><a href="#오른쪽에서부터-인자-적용해두기" class="headerlink" title="오른쪽에서부터 인자 적용해두기"></a>오른쪽에서부터 인자 적용해두기</h3><p><code>_.partial</code>을 실행하면 <code>___</code>를 기준으로 왼편의 인자들을 왼쪽부터 적용하고 오른편의 인자들을 오른쪽부터 적용할 준비를 해둔 함수를 리턴합니다. 부분 적용된 함수를 나중에 실행하면 그때 받은 인자들로 왼쪽과 오른쪽을 먼저 채운 후, 남은 인자들로 가운데 <code>___</code> 자리를 채웁니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> pc = _.partial(<span class="built_in">console</span>.log, ___, <span class="number">2</span>, <span class="number">3</span>);</div><div class="line">pc(<span class="number">1</span>);</div><div class="line"><span class="comment">// 결과: 1 2 3</span></div><div class="line"><span class="comment">// ___ 자리에 1이 들어가고 2, 3은 맨 오른쪽에 들어갑니다.</span></div><div class="line">pc(<span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>);</div><div class="line"><span class="comment">// 결과: 1 4 5 6 2 3</span></div><div class="line"><span class="comment">// ___ 자리에 1, 4, 5, 6이 들어가고 2, 3은 맨 오른쪽에 들어갑니다.</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> pc = _.partial(<span class="built_in">console</span>.log, _, <span class="number">2</span>, ___, <span class="number">6</span>);</div><div class="line">pc(<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</div><div class="line"><span class="comment">// 결과: 1 2 3 4 5 6</span></div><div class="line"><span class="comment">// _에 1이 들어가고 2를 넘어가고 ___ 자리에 3, 4, 5가 채워지고 6이 맨 오른쪽에 들어갑니다.</span></div><div class="line">pc(<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>);</div><div class="line"><span class="comment">// 결과: 1 2 3 4 5 7 8 9 6</span></div><div class="line"><span class="comment">// _에 1이 들어가고 2를 넘어가고 ___ 자리에 3, 4, 5, 7, 8, 9가 채워지고 6이 맨 오른쪽에 들어갑니다.</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> pc = _.partial(<span class="built_in">console</span>.log, _, <span class="number">2</span>, ___, <span class="number">5</span>, _, <span class="number">7</span>);</div><div class="line">pc(<span class="number">1</span>);</div><div class="line"><span class="comment">// 결과: 1 2 5 undefined 7</span></div><div class="line"><span class="comment">// _ 자리에 1이 들어가고 2와 5사이는 유동적이므로 모이고 5가 들어간 후 _가 undefined로 대체 되고 7이 들어갑니다.</span></div><div class="line">pc(<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>);</div><div class="line"><span class="comment">// 결과: 1 2 3 5 4 7</span></div><div class="line"><span class="comment">// _ 자리에 1이 들어가고 2와 5사이에 3이 들어가고 _ 를 4로 채운 후 7이 들어갑니다.</span></div><div class="line"><span class="comment">// 왼쪽의 _ 들이 우선 순위가 제일 높고 ___ 보다 오른쪽의 _ 들이 우선순위가 높습니다.</span></div><div class="line">pc(<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>);</div><div class="line"><span class="comment">// 결과: 1 2 3 4 6 5 8 7</span></div><div class="line"><span class="comment">// _ 자리에 1이 들어가고 2와 5사이에 3, 4, 6이 들어가고 _ 를 8로 채운 후 7이 들어갑니다.</span></div></pre></td></tr></table></figure>
<h3 id="간결하게-사용하기"><a href="#간결하게-사용하기" class="headerlink" title="간결하게 사용하기"></a>간결하게 사용하기</h3><p><code>_ == _.partial</code>입니다. <code>_.partial</code>을 <code>_</code>로 간결하게 표현할 수 있습니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> a + b;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> add10 = _(add, <span class="number">10</span>);</div><div class="line"><span class="built_in">console</span>.log( add10(<span class="number">5</span>) );</div><div class="line"><span class="comment">// 15</span></div></pre></td></tr></table></figure>
<h2 id="파이프라인"><a href="#파이프라인" class="headerlink" title="파이프라인"></a>파이프라인</h2><p>파이프라인 함수인 <code>_.pipe</code>, <code>_.go</code> 등은 작은 함수들을 모아 큰 함수를 만드는 함수입니다. 파이프라인으로 함수를 조합하면 왼쪽에서부터 오른쪽, 위에서부터 아래로 표현되어 읽기 쉬운 코드가 됩니다. 체인 방식과 다르게 아무 함수나 사용할 수 있어 자유도가 높습니다. 작은 함수들을 인자와 결과만을 생각하면서 조합하면 됩니다.</p>
<h3 id="즉시-실행과-Multiple-Results"><a href="#즉시-실행과-Multiple-Results" class="headerlink" title="즉시 실행과 Multiple Results"></a>즉시 실행과 Multiple Results</h3><p><code>_.go</code>는 파이프라인의 즉시 실행 버전입니다. 첫 번째 인자로 받은 값을 두 번째 인자로 받은 함수에게 넘겨주고 두 번째 인자로 받은 함수의 결과는 세 번째 함수에게 넘겨주는 것을 반복하다가 마지막 함수의 결과를 리턴해줍니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">_.go(<span class="number">10</span>, <span class="comment">// 첫 번째 함수에서 사용할 인자</span></div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123; <span class="keyword">return</span> a * <span class="number">10</span> &#125;, <span class="comment">// 연속 실행할 함수 1</span></div><div class="line">  <span class="comment">// 100</span></div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123; <span class="keyword">return</span> a - <span class="number">50</span> &#125;, <span class="comment">// 연속 실행할 함수 2</span></div><div class="line">  <span class="comment">// 50</span></div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123; <span class="keyword">return</span> a + <span class="number">10</span> &#125;); <span class="comment">// 연속 실행할 함수 3</span></div><div class="line">  <span class="comment">// 60</span></div></pre></td></tr></table></figure>
<p><code>_.go</code>는 Multiple Results를 지원합니다. <code>_.mr</code> 함수를 함께 사용하면 다음 함수에게 2개 이상의 인자들을 전달할 수 있습니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">_.go(<span class="number">10</span>, <span class="comment">// 첫 번째 함수에서 사용할 인자</span></div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123; <span class="keyword">return</span> _.mr(a * <span class="number">10</span>, <span class="number">50</span>) &#125;, <span class="comment">// 두 개의 값을 리턴</span></div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123; <span class="keyword">return</span> a - b &#125;, <span class="comment">// 두 개의 인자 받기</span></div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123; <span class="keyword">return</span> a + <span class="number">10</span> &#125;);</div><div class="line">  <span class="comment">// 60</span></div></pre></td></tr></table></figure>
<p><code>_.go</code>의 첫 번째 인자는 두 번째 인자인 함수가 사용할 인자고 두 번째 부터는 파이프라인에서 사용할 함수들입니다. <code>_.go</code>의 두 번째 인자인 함수, 즉 최초 실행될 함수에게 2개 이상의 인자를 넘기고자 한다면 <code>_.mr</code>을 사용하면 됩니다. <code>_.mr</code>로 인자들을 감싸서 넘겨주면, 다음 함수는 인자를 여러 개로 펼쳐서 받게 됩니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">_.go(_.mr(<span class="number">2</span>, <span class="number">3</span>),</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> a + b; <span class="comment">// 2 + 3</span></div><div class="line">  &#125;,</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> a * a;</div><div class="line">  &#125;);</div><div class="line">  <span class="comment">// 25</span></div></pre></td></tr></table></figure>
<p><code>_.go</code>를 이미 정의되어 있는 함수와 조합하거나 화살표 함수와 사용하면 더욱 읽기 좋아집니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> a + b;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">square</span>(<span class="params">a</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> a * a;</div><div class="line">&#125;</div><div class="line">_.go(_.mr(<span class="number">2</span>, <span class="number">3</span>), add, square);</div><div class="line"><span class="comment">// 25</span></div><div class="line"></div><div class="line">_.go(_.mr(<span class="number">2</span>, <span class="number">3</span>), (a, b) =&gt; a + b, a =&gt; a * a);</div><div class="line"><span class="comment">// 25</span></div></pre></td></tr></table></figure>
<h3 id="파이프라인-함수를-리턴하는-pipe"><a href="#파이프라인-함수를-리턴하는-pipe" class="headerlink" title="파이프라인 함수를 리턴하는 _.pipe"></a>파이프라인 함수를 리턴하는 _.pipe</h3><p><code>_.go</code>가 즉시 실행하는 파이프라인이라면 <code>_.pipe</code>는 실행할 준비가 된 함수를 리턴하는 파이프라인 함수입니다. 그외 모든 기능은 <code>_.go</code>와 동일합니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> f1 = _.pipe(add, square);</div><div class="line">f1(<span class="number">2</span>, <span class="number">3</span>);</div><div class="line"><span class="comment">// 25</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> f2 = _.pipe(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b, a =&gt; a * a);</div><div class="line">f2(<span class="number">2</span>, <span class="number">3</span>);</div><div class="line"><span class="comment">// 25</span></div></pre></td></tr></table></figure>
<h2 id="부분-커링"><a href="#부분-커링" class="headerlink" title="부분 커링"></a>부분 커링</h2><h3 id="커링이-부분적으로-동작하는-함수"><a href="#커링이-부분적으로-동작하는-함수" class="headerlink" title="커링이 부분적으로 동작하는 함수"></a>커링이 부분적으로 동작하는 함수</h3><p>Partial.js의 주요 함수들은 커링이 부분적으로 동작하도록 지원하고 있습니다. 아래는 일반적인 사용 모습입니다.</p>
<h5 id="일반적인-방식"><a href="#일반적인-방식" class="headerlink" title="일반적인 방식:"></a>일반적인 방식:</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> values = <span class="function"><span class="keyword">function</span>(<span class="params">list</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> _.map(list, <span class="function"><span class="keyword">function</span>(<span class="params">v</span>) </span>&#123; <span class="keyword">return</span> v; &#125;)</div><div class="line">&#125;;</div><div class="line"><span class="built_in">console</span>.log(values(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">4</span> &#125;));</div><div class="line"><span class="comment">// [1, 2, 4]</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> take3 = <span class="function"><span class="keyword">function</span>(<span class="params">list</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> _.take(list, <span class="number">3</span>);</div><div class="line">&#125;;</div><div class="line">take3([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]);</div><div class="line"><span class="comment">// [1, 2, 3]</span></div></pre></td></tr></table></figure>
<p>Partial.js의 주요 함수들은 부분 커링이 적용되어 위와 동일한 동작을 아래와 같이 간결하게 표현할 수 있습니다.</p>
<h5 id="부분-커링이-지원될-경우"><a href="#부분-커링이-지원될-경우" class="headerlink" title="부분 커링이 지원될 경우:"></a>부분 커링이 지원될 경우:</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> values = _.map(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>) </span>&#123; <span class="keyword">return</span> v; &#125;);</div><div class="line"><span class="built_in">console</span>.log(values(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">4</span> &#125;));</div><div class="line"><span class="comment">// [1, 2, 4]</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> take3 = _.take(<span class="number">3</span>);</div><div class="line">take3([<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]);</div><div class="line"><span class="comment">// [1, 3, 5]</span></div></pre></td></tr></table></figure>
<h3 id="파이프라인과-함께"><a href="#파이프라인과-함께" class="headerlink" title="파이프라인과 함께"></a>파이프라인과 함께</h3><p>부분 커링이 지원되면 파이프라인과 함께 사용할 때, 체인처럼 간결한 표현이 가능합니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> users = [</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">"ID"</span>, <span class="attr">age</span>: <span class="number">32</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">"HA"</span>, <span class="attr">age</span>: <span class="number">25</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">"BJ"</span>, <span class="attr">age</span>: <span class="number">32</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">name</span>: <span class="string">"PJ"</span>, <span class="attr">age</span>: <span class="number">28</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">5</span>, <span class="attr">name</span>: <span class="string">"JE"</span>, <span class="attr">age</span>: <span class="number">27</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">6</span>, <span class="attr">name</span>: <span class="string">"JM"</span>, <span class="attr">age</span>: <span class="number">32</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">7</span>, <span class="attr">name</span>: <span class="string">"JI"</span>, <span class="attr">age</span>: <span class="number">31</span> &#125;</div><div class="line">];</div><div class="line"></div><div class="line"><span class="comment">/* 일반적인 사용 */</span></div><div class="line">_.go(users,</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">users</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> _.filter(users, <span class="function"><span class="keyword">function</span>(<span class="params">u</span>) </span>&#123; <span class="keyword">return</span> u.age &lt; <span class="number">30</span>; &#125;);</div><div class="line">  &#125;,</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">users</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> _.pluck(users, <span class="string">'name'</span>);</div><div class="line">  &#125;,</div><div class="line">  <span class="built_in">console</span>.log);</div><div class="line"><span class="comment">// ["HA", "PJ", "JE"]</span></div><div class="line"></div><div class="line"><span class="comment">/* 부분 적용 */</span></div><div class="line">_.go(users,</div><div class="line">  _.partial(_.filter, _, <span class="function"><span class="keyword">function</span>(<span class="params">u</span>) </span>&#123; <span class="keyword">return</span> u.age &lt; <span class="number">30</span>; &#125;),</div><div class="line">  _.partial(_.pluck, _, <span class="string">'name'</span>),</div><div class="line">  <span class="built_in">console</span>.log);</div><div class="line"><span class="comment">// ["HA", "PJ", "JE"]</span></div><div class="line"></div><div class="line"><span class="comment">/* 부분 커링이 된다면 */</span></div><div class="line">_.go(users,</div><div class="line">  _.filter(<span class="function"><span class="keyword">function</span>(<span class="params">u</span>) </span>&#123; <span class="keyword">return</span> u.age &lt; <span class="number">30</span>; &#125;),</div><div class="line">  _.pluck(<span class="string">'name'</span>),</div><div class="line">  <span class="built_in">console</span>.log);</div><div class="line"><span class="comment">// ["HA", "PJ", "JE"]</span></div><div class="line"></div><div class="line"><span class="comment">/* Underscore.js 체인 */</span></div><div class="line">underscore.chain(users)</div><div class="line">  .filter(<span class="function"><span class="keyword">function</span>(<span class="params">u</span>) </span>&#123; <span class="keyword">return</span> u.age &lt; <span class="number">30</span>; &#125;)</div><div class="line">  .pluck(<span class="string">'name'</span>)</div><div class="line">  .tap(<span class="built_in">console</span>.log);</div><div class="line"><span class="comment">// ["HA", "PJ", "JE"]</span></div></pre></td></tr></table></figure>
<p><code>_.go</code>, <code>_.pipe</code> 등의 파이프라인이 받는 재료는 함수이기 때문에 아무 함수나 조합할 수 있습니다. 체인처럼 메서드 등으로 준비되어있지 않아도 되며 Partial.js의 함수만 사용할 필요도 없습니다. Partial.js의 파이프라인은 결과를 여러 개로 리턴할 수 있고, 여러 개의 인자를 받을 수 있고, 다른 라이브러리에 있는 함수든, 직접 만든 함수든, 익명 함수든 모두 쉽게 사용할 수 있습니다.</p>
<h2 id="비동기"><a href="#비동기" class="headerlink" title="비동기"></a>비동기</h2><p>Promise가 지원되지 않는 환경에서도 Partial.js만으로 다양한 비동기 상황을 간단히 제어할 수 있습니다.</p>
<h3 id="파이프라인으로-비동기-제어-하기"><a href="#파이프라인으로-비동기-제어-하기" class="headerlink" title="파이프라인으로 비동기 제어 하기"></a>파이프라인으로 비동기 제어 하기</h3><p><code>_.go</code>, <code>_.pipe</code> 등의 파이프라인 함수들은 비동기 제어를 지원합니다. <code>_.go</code>는 함수들을 순차적으로 실행해나가다가 비동기 함수의 결과를 재귀 함수로 꺼낸 후, 다음 함수에게 전달하는 식으로 비동기 상황을 제어합니다. Partial.js의 파이프라인에서는 일반 콜백 함수와 Promise를 모두 지원합니다. <code>_.go</code>와 <code>_.pipe</code>는 파이프라인의 함수들을 실행하는 도중, <code>Promise</code> 객체를 만나거나, jQuery의 Deferred Object를 만나면 자동으로 비동기를 제어하는 파이프라인으로 변합니다. 중간에서 비동기를 만나지 않으면 예정대로 결과를 즉시 리턴합니다.</p>
<h5 id="Promise와-사용"><a href="#Promise와-사용" class="headerlink" title="Promise와 사용:"></a>Promise와 사용:</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">_.go(<span class="number">10</span>,</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</div><div class="line">      setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        resolve(a + <span class="number">10</span>);</div><div class="line">      &#125;, <span class="number">1000</span>);</div><div class="line">    &#125;);</div><div class="line">  &#125;,</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123; <span class="comment">// 1초 뒤 실행</span></div><div class="line">    <span class="built_in">console</span>.log(a);</div><div class="line">    <span class="comment">// 20</span></div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<h5 id="일반-콜백-패턴의-함수"><a href="#일반-콜백-패턴의-함수" class="headerlink" title="일반 콜백 패턴의 함수:"></a>일반 콜백 패턴의 함수:</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">_.go(<span class="number">10</span>,</div><div class="line">  _.callback(<span class="function"><span class="keyword">function</span>(<span class="params">a, next</span>) </span>&#123;</div><div class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      next(a + <span class="number">10</span>);</div><div class="line">    &#125;, <span class="number">100</span>)</div><div class="line">  &#125;),</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123; <span class="comment">// next를 통해 받은 결과 a</span></div><div class="line">    <span class="built_in">console</span>.log(a);</div><div class="line">    <span class="comment">// 20</span></div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<p>파이프라인은 <code>_.callback</code>으로 감싸진 익명 함수에게 마지막 인자로 <code>next</code> 함수를 전달합니다. <code>next</code> 함수에게 결과를 전달하면 다음 함수로 넘어가게 됩니다. 만약에 원래 마지막 인자로 <code>callback</code> 함수를 받고 있던 함수일 경우, <code>_.callback</code>으로 감싸주기만 하면 파이프라인과 사용할 수 있습니다.</p>
<p><code>_.callback</code>으로 감싸진 익명 함수는 <code>Promise</code> 객체를 리턴합니다. 정확히는 <code>Promise</code>가 지원되는 환경에서는 <code>Promise</code> 객체를 리턴하고, <code>Promise</code>가 지원되지 않는 환경에서는 약식 <code>Promise</code>를 리턴합니다. 약식 <code>Promise</code>를 받아도 파이프라인이 비동기를 제어하기 때문에 <code>Promise</code>를 지원하지 않는 환경에서도 파이프라인식의 비동기 제어가 가능합니다. 브라우저에서도 별도의 <code>Promise</code> 라이브러리를 가져올 필요가 없습니다.</p>
<h3 id="컬렉션을-다루는-비동기-제어-함수"><a href="#컬렉션을-다루는-비동기-제어-함수" class="headerlink" title="컬렉션을 다루는 비동기 제어 함수"></a>컬렉션을 다루는 비동기 제어 함수</h3><p>Partial.js의 <code>_.each</code>, <code>_.map</code>, <code>_.reduce</code> 등의 주요 함수들은 <code>_.go</code>와 <code>_.pipe</code>처럼 동기와 비동기 상황이 모두 대응되도록 되어 있습니다. Partial.js의 함수를 이용하면 비동기 상황에서도 동기 상황과 동일한 코드를 작성할 수 있고, 비동기 함수와 동기 함수의 조합도 가능합니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">syncDate</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">promiseDate</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</div><div class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      resolve(<span class="keyword">new</span> <span class="built_in">Date</span>());</div><div class="line">    &#125;, <span class="number">1000</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">_.go([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">  _.map(syncDate),</div><div class="line">  _.map(<span class="function"><span class="params">d</span> =&gt;</span> d.toString()),</div><div class="line">  <span class="built_in">console</span>.log);</div><div class="line"><span class="comment">// 결과:</span></div><div class="line"><span class="comment">//  ["Sun Feb 05 2017 03:33:36 GMT+0900 (KST)",</span></div><div class="line"><span class="comment">//   "Sun Feb 05 2017 03:33:36 GMT+0900 (KST)",</span></div><div class="line"><span class="comment">//   "Sun Feb 05 2017 03:33:36 GMT+0900 (KST)"]</span></div><div class="line"></div><div class="line">_.go([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">  _.map(promiseDate),</div><div class="line">  _.map(<span class="function"><span class="params">d</span> =&gt;</span> d.toString()),</div><div class="line">  <span class="built_in">console</span>.log);</div><div class="line"><span class="comment">// 결과:</span></div><div class="line"><span class="comment">//  ["Sun Feb 05 2017 03:33:37 GMT+0900 (KST)",</span></div><div class="line"><span class="comment">//   "Sun Feb 05 2017 03:33:38 GMT+0900 (KST)",</span></div><div class="line"><span class="comment">//   "Sun Feb 05 2017 03:33:39 GMT+0900 (KST)"]</span></div></pre></td></tr></table></figure>
<p>위 사례처럼 Partial.js는 <code>_.go</code>, <code>_.pipe</code>, <code>_.each</code>, <code>_.map</code>, <code>_.find</code>, <code>_.filter</code>, <code>_.reject</code>, <code>_.reduce</code>, <code>_.some</code>, <code>_.every</code>, <code>_.if().else_if().else()</code> 등의 함수들에서 자동 비동기 제어 로직을 지원합니다.</p>
<h2 id="값-다루기"><a href="#값-다루기" class="headerlink" title="값 다루기"></a>값 다루기</h2><h3 id="불변적으로-다루기"><a href="#불변적으로-다루기" class="headerlink" title="불변적으로 다루기"></a>불변적으로 다루기</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> users = [</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">"ID"</span>, <span class="attr">age</span>: <span class="number">32</span> &#125;,</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">"HA"</span>, <span class="attr">age</span>: <span class="number">25</span> &#125;,</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">"BJ"</span>, <span class="attr">age</span>: <span class="number">32</span> &#125;,</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">"PJ"</span>, <span class="attr">age</span>: <span class="number">28</span> &#125;,</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">"JE"</span>, <span class="attr">age</span>: <span class="number">27</span> &#125;</div><div class="line">];</div><div class="line"></div><div class="line"><span class="keyword">var</span> sortedUsers = _.sortBy(users, <span class="string">'age'</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(users == sortedUsers);</div><div class="line"><span class="comment">// false</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(_.pluck(sortedUsers, <span class="string">'age'</span>));</div><div class="line"><span class="comment">// [25, 27, 28, 32, 32]</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(_.pluck(users, <span class="string">'age'</span>));</div><div class="line"><span class="comment">// [32, 25, 32, 28, 27]</span></div></pre></td></tr></table></figure>
<p><code>sortedUsers</code>는 새로운 객체입니다. <code>sortedUsers</code>는 나이순으로 정렬이 되었는데, <code>users</code>는 원본 그대로 유지됩니다. 다른 곳에서 <code>users</code>에 의존하느 ㄴ곳이 있다면 <code>sortedUsers</code>처럼 새로운 객체를 만들어 정렬을 하는 방식이 부수효과가 없고 유리합니다.</p>
<p><code>sortedUsers</code>는 새로운 값이지만 배열안의 값은 기존 값을 공유합니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(users[<span class="number">1</span>] == sortedUsers[<span class="number">0</span>]);</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>두 배열 안에 있는 모든 값들은 새로운 값이 아닌 기존의 값입니다. 항상 배열 내의 모든 값을 새롭게 만든다면 메모리 사용량이 높아지겠지만 <code>_.sortBy</code>는 내부의 값은 기존의 값을 그대로 공유하고 배열만 새로 만들어 정렬하기 때문에 효율적입니다. 이런 전략을 잘 이용하면 부수효과를 줄이면서도 메모리 사용량 증가는 최소화할 수 있습니다.</p>
<p><code>_.reject</code> 등의 함수도 동일한 방식으로 동작합니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> rejectedUsers = _.reject(users, <span class="function"><span class="keyword">function</span>(<span class="params">user</span>) </span>&#123; <span class="keyword">return</span> user.age &lt; <span class="number">30</span>; &#125;);</div><div class="line"><span class="built_in">console</span>.log(rejectedUsers);</div><div class="line"><span class="comment">// [&#123; name: "ID", age: 32 &#125;, &#123; name: "BJ", age: 32 &#125;]</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(rejectedUsers == users);</div><div class="line"><span class="comment">// false</span></div><div class="line"><span class="built_in">console</span>.log(rejectedUsers.length, users.length);</div><div class="line"><span class="comment">// 2 5</span></div><div class="line"><span class="built_in">console</span>.log(rejectedUsers[<span class="number">0</span>] == users[<span class="number">0</span>]);</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>함수형 자바스크립트 라이브러리의 함수들은 값을 직접 변경하는 것이 아닌, 변경된 새로운 값을 만드는 방식으로 데이터를 변형해나갑니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> b1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</div><div class="line"><span class="keyword">var</span> b2 = _.initial(b1, <span class="number">2</span>); <span class="comment">// 뒤에서 2개 제거한 새로운 배열 리턴</span></div><div class="line"><span class="built_in">console</span>.log(b1 == b2, b1, b2);</div><div class="line"><span class="comment">// false [1, 2, 3, 4, 5] [1, 2, 3]</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> b3 = _.without(b1, <span class="number">1</span>, <span class="number">5</span>); <span class="comment">// 1과 5를 제거한 새로운 배열 리턴</span></div><div class="line"><span class="keyword">var</span> b4 = _.without(b3, <span class="number">2</span>); <span class="comment">// 2를 제거한 새로운 배열 리턴</span></div><div class="line"><span class="built_in">console</span>.log(b1 == b3, b3 == b4, b3, b4);</div><div class="line"><span class="comment">// false false [2, 3, 4] [3, 4]</span></div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure>
<h3 id="깊은-값-찾기와-JSON-Selector"><a href="#깊은-값-찾기와-JSON-Selector" class="headerlink" title="깊은 값 찾기와 JSON Selector"></a>깊은 값 찾기와 JSON Selector</h3><p>Partial.js에는 중첩된 기본 객체에 대한 조회와 변형을 돕는 함수들이 있습니다. Partial.js에서는 깊은 값을 찾아가기 위한 JSON Selector를 만들었습니다. JSON Selector는 문자열로 작성하며, 함수적인 기능도 지원하여 다양한 조건으로 데이터를 찾아갈 수 있습니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> users = [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">name</span>: <span class="string">'BJ'</span>,</div><div class="line">    <span class="attr">post_count</span>: <span class="number">3</span>,</div><div class="line">    <span class="attr">posts</span>: [</div><div class="line">      &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">body</span>: <span class="string">'하이'</span>, <span class="attr">comments</span>: [&#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">body</span>: <span class="string">'코멘트3'</span> &#125;] &#125;,</div><div class="line">      &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">body</span>: <span class="string">'하이2'</span>, <span class="attr">comments</span>: [&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">body</span>: <span class="string">'코멘트1'</span> &#125;, &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">body</span>: <span class="string">'코멘트2'</span> &#125;] &#125;,</div><div class="line">      &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">body</span>: <span class="string">'하이4'</span>, <span class="attr">comments</span>: [&#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">body</span>: <span class="string">'코멘트4'</span> &#125;, &#123; <span class="attr">id</span>: <span class="number">5</span>, <span class="attr">body</span>: <span class="string">'코멘트5'</span> &#125;] &#125;</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="attr">id</span>: <span class="number">2</span>,</div><div class="line">    <span class="attr">name</span>: <span class="string">'PJ'</span>,</div><div class="line">    <span class="attr">post_count</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">posts</span>: [</div><div class="line">      &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">body</span>: <span class="string">'하이3'</span>, <span class="attr">comments</span>: [] &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">];</div><div class="line"></div><div class="line"><span class="comment">// key로만 찾기</span></div><div class="line"><span class="built_in">console</span>.log(</div><div class="line">  _.sel(users, <span class="string">'0-&gt;name'</span>), <span class="comment">// BJ</span></div><div class="line">  _.sel(users, <span class="string">'1-&gt;name'</span>), <span class="comment">// PJ</span></div><div class="line">  _.sel(users, <span class="string">'0-&gt;post_count'</span>), <span class="comment">// 3</span></div><div class="line">  _.sel(users, <span class="string">'1-&gt;post_count'</span>), <span class="comment">// 1</span></div><div class="line">  _.sel(users, <span class="string">'0-&gt;posts-&gt;1-&gt;body'</span>) <span class="comment">// 하이2</span></div><div class="line">);</div><div class="line"></div><div class="line"><span class="comment">// 괄호로 내부적으로 find + predicate 실행하기</span></div><div class="line"><span class="built_in">console</span>.log(</div><div class="line">  _.sel(users, <span class="string">'(u=&gt;u.id==1) -&gt; name'</span>), <span class="comment">// BJ</span></div><div class="line">  _.sel(users, <span class="string">'(u=&gt;u.id==1) -&gt; posts -&gt; (p=&gt;p.id==4) -&gt; body'</span>) <span class="comment">// 하이4</span></div><div class="line">);</div><div class="line"></div><div class="line"><span class="comment">// 위 코드는 아래와 같습니다.</span></div><div class="line">_.go(users,</div><div class="line">  _.find(<span class="function"><span class="keyword">function</span>(<span class="params">u</span>) </span>&#123; <span class="keyword">return</span> u.id == <span class="number">1</span>; &#125;),</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">user</span>) </span>&#123; <span class="keyword">return</span> user.name; &#125;,</div><div class="line">  <span class="built_in">console</span>.log); <span class="comment">// BJ</span></div><div class="line"></div><div class="line">_.go(users,</div><div class="line">  _.find(<span class="function"><span class="keyword">function</span>(<span class="params">u</span>) </span>&#123; <span class="keyword">return</span> u.id == <span class="number">1</span>; &#125;),</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">user</span>) </span>&#123; <span class="keyword">return</span> user.posts; &#125;,</div><div class="line">  _.find(<span class="function"><span class="keyword">function</span>(<span class="params">p</span>) </span>&#123; <span class="keyword">return</span> p.id == <span class="number">4</span>; &#125;),</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">user</span>) </span>&#123; <span class="keyword">return</span> user.body; &#125;,</div><div class="line">  <span class="built_in">console</span>.log); <span class="comment">// 하이4</span></div><div class="line"></div><div class="line"><span class="comment">// 동일 코드를 아래처럼 더 짧게 표현할 수 있습니다.</span></div><div class="line"><span class="built_in">console</span>.log(</div><div class="line">  _.sel(users, <span class="string">'($.id==1) -&gt; name'</span>), <span class="comment">// BJ</span></div><div class="line">  _.sel(users, <span class="string">'(#1) -&gt; posts -&gt; (#4) -&gt; body'</span>) <span class="comment">// 하이4</span></div><div class="line">);</div><div class="line"></div><div class="line"><span class="comment">// ($.id==1)는 function($) &#123; return $.id == 1 &#125;와 같습니다.</span></div><div class="line"><span class="comment">// (#4)는 function($) &#123; return $.id == 4 &#125; 와 같습니다.</span></div></pre></td></tr></table></figure>
<p><code>()</code>를 사용할 때 <code>id</code>로 비교하는 경우에는 <code>#</code>을 사용하는 방식이 성능이 가장 좋습니다. JSON Selector는 <code>()</code>를 통해 <code>find(predicate)</code>를 작성할 수 있어 단순히 key들로 찾아가는 방법보다 유용합니다. JSON Selector의 <code>()</code>는 함수이므로, <code>id</code> 비교외에 다른 조건도 만들 수 있습니다.</p>
<h3 id="깊은-값-가변적으로-변경하기"><a href="#깊은-값-가변적으로-변경하기" class="headerlink" title="깊은 값 가변적으로 변경하기"></a>깊은 값 가변적으로 변경하기</h3><p>JSON Selector를 지원하는 Partial.js의 함수들을 이용하면 중첩 구조 객체의 안쪽 값을 찾고 변경하기 편합니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> user = &#123;</div><div class="line">  <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">  <span class="attr">name</span>: <span class="string">'BJ'</span>,</div><div class="line">  <span class="attr">post_count</span>: <span class="number">3</span>,</div><div class="line">  <span class="attr">posts</span>: [</div><div class="line">    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">body</span>: <span class="string">'하이'</span>, <span class="attr">comments</span>: [&#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">body</span>: <span class="string">'코멘트3'</span> &#125;] &#125;,</div><div class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">body</span>: <span class="string">'하이2'</span>, <span class="attr">comments</span>: [&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">body</span>: <span class="string">'코멘트1'</span> &#125;, &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">body</span>: <span class="string">'코멘트2'</span> &#125;] &#125;,</div><div class="line">    &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">body</span>: <span class="string">'하이4'</span>, <span class="attr">comments</span>: [&#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">body</span>: <span class="string">'코멘트4'</span> &#125;, &#123; <span class="attr">id</span>: <span class="number">5</span>, <span class="attr">body</span>: <span class="string">'코멘트5'</span> &#125;] &#125;</div><div class="line">  ]</div><div class="line">&#125;;</div><div class="line"></div><div class="line">_.go(</div><div class="line">  _.set(user, <span class="string">'posts -&gt; (#4) -&gt; comments -&gt; (#4) -&gt; body'</span>, <span class="string">'코멘트4를 수정'</span>),</div><div class="line">  <span class="built_in">console</span>.log);</div><div class="line"><span class="comment">// arguments &#123; ... &#125;</span></div><div class="line"><span class="comment">// [0] 내부가 변경된 user 전체</span></div><div class="line"><span class="comment">// [1] "코멘트4를 수정"</span></div><div class="line"><span class="comment">// [2] "body"</span></div><div class="line"><span class="comment">// [3] &#123; id: 4, body: '코멘트4를 수정' &#125;</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log( user.posts[<span class="number">2</span>].comments[<span class="number">0</span>].body );</div><div class="line"><span class="comment">// 코멘트4를 수정</span></div></pre></td></tr></table></figure>
<p><code>_.set</code>을 사용하면 깊은 값을 JSON Selector로 찾아간 다음, 마지막 key에 해당하는 값을 변경하게 됩니다.</p>
<h3 id="깊은-값을-불변적으로-변경하기"><a href="#깊은-값을-불변적으로-변경하기" class="headerlink" title="깊은 값을 불변적으로 변경하기"></a>깊은 값을 불변적으로 변경하기</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">_.go(</div><div class="line">  _.im.set(user, <span class="string">'posts -&gt; (#4) -&gt; comments -&gt; (#4) -&gt; body'</span>, <span class="string">'코멘트4를 새롭게 수정'</span>),</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">user2</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(</div><div class="line">      user == user2, <span class="comment">// false</span></div><div class="line">      user.posts[<span class="number">2</span>].comments[<span class="number">0</span>].body, <span class="comment">// 코멘트4를 수정</span></div><div class="line">      user2.posts[<span class="number">2</span>].comments[<span class="number">0</span>].body, <span class="comment">// 코멘트4를 새롭게 수정</span></div><div class="line"></div><div class="line">      user.posts == user2.posts, <span class="comment">// false</span></div><div class="line">      user.posts[<span class="number">0</span>] == user2.posts[<span class="number">0</span>], <span class="comment">// true 기존 값 공유</span></div><div class="line">      user.posts[<span class="number">1</span>] == user2.posts[<span class="number">1</span>], <span class="comment">// true 기존 값 공유</span></div><div class="line">      user.posts[<span class="number">2</span>] == user2.posts[<span class="number">2</span>], <span class="comment">// false 부모 라인이므로 새로운 값</span></div><div class="line">      user.posts[<span class="number">2</span>].comments[<span class="number">0</span>] == user2.posts[<span class="number">2</span>].comments[<span class="number">0</span>], <span class="comment">// false 새로운 값</span></div><div class="line">      user.posts[<span class="number">2</span>].comments[<span class="number">1</span>] == user2.posts[<span class="number">2</span>].comments[<span class="number">1</span>] <span class="comment">// true 기존 값 공유</span></div><div class="line">    )</div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<p><code>_.set</code>의 immutable 버전인 <code>_.im.set</code>은 안쪽 값이 변경된 새로운 부모 객체를 리턴합니다. <code>start</code> 객체인 <code>user</code>는 새로운 객체인 <code>user2</code>가 되고, 중첩 구조를 파고들면서, 새로 만들어야 하는 값만 새로 만들고, 그대로 재활용해도 되는 데이터는 이전 값을 공유합니다. immutable.js 처럼 값 복사에 있어 재활용할 수 있는 객체를 최대한 남겨 불필요한 메모리 사용을 줄였습니다.</p>
<p>다음은 좀 더 다양한 사례입니다.</p>
<h3 id="다양한-깊은-값-다루기-함수"><a href="#다양한-깊은-값-다루기-함수" class="headerlink" title="다양한 깊은 값 다루기 함수"></a>다양한 깊은 값 다루기 함수</h3><p>JSON Selector를 통해 깊은 값을 변경할 수 있는 함수는 <code>_.set</code>, <code>_.unset</code>, <code>_.remove2</code>, <code>_.pop</code>, <code>_.shift</code>, <code>_.push</code>, <code>_.unshift</code> 등이 있고 그 외에 <code>_.extend2</code>, <code>_.defaults2</code> 등도 있습니다. 각각의 모든 함수는 <code>_.im.set</code>과 같이 <code>_.im</code>를 붙이면 immutable 버전으로 동작하여 부모 객체의 복사본을 리턴합니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> users = [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">name</span>: <span class="string">'BJ'</span>,</div><div class="line">    <span class="attr">post_count</span>: <span class="number">3</span>,</div><div class="line">    <span class="attr">posts</span>: [</div><div class="line">      &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">body</span>: <span class="string">'하이'</span>, <span class="attr">comments</span>: [&#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">body</span>: <span class="string">'코멘트3'</span> &#125;] &#125;,</div><div class="line">      &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">body</span>: <span class="string">'하이2'</span>, <span class="attr">comments</span>: [&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">body</span>: <span class="string">'코멘트1'</span> &#125;, &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">body</span>: <span class="string">'코멘트2'</span> &#125;] &#125;,</div><div class="line">      &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">body</span>: <span class="string">'하이4'</span>, <span class="attr">comments</span>: [&#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">body</span>: <span class="string">'코멘트4'</span> &#125;, &#123; <span class="attr">id</span>: <span class="number">5</span>, <span class="attr">body</span>: <span class="string">'코멘트5'</span> &#125;] &#125;</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="attr">id</span>: <span class="number">2</span>,</div><div class="line">    <span class="attr">name</span>: <span class="string">'PJ'</span>,</div><div class="line">    <span class="attr">post_count</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">posts</span>: [</div><div class="line">      &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">body</span>: <span class="string">'하이3'</span>, <span class="attr">comments</span>: [] &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">];</div><div class="line"></div><div class="line">_.unset(users, <span class="string">'(#2)-&gt;name'</span>);</div><div class="line"><span class="built_in">console</span>.log(users[<span class="number">1</span>]); <span class="comment">// &#123;id: 2, post_count: 1, posts: Array[1]&#125;</span></div><div class="line"></div><div class="line">_.remove2(users, <span class="string">'(#1)-&gt;posts-&gt;(#2)'</span>);</div><div class="line"><span class="built_in">console</span>.log(_.pluck(users[<span class="number">0</span>].posts, <span class="string">'body'</span>)); <span class="comment">// ["하이", "하이4"]</span></div><div class="line"></div><div class="line">_.go(_.im.remove2(users, <span class="string">'(#2)-&gt;posts-&gt;(#3)'</span>), <span class="comment">// immutable</span></div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">users2</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(users2[<span class="number">1</span>].posts); <span class="comment">// []</span></div><div class="line">    <span class="built_in">console</span>.log(users[<span class="number">1</span>].posts); <span class="comment">// [&#123; id: 3, body: '하이3', comments: [] &#125;]</span></div><div class="line">  &#125;);</div><div class="line"></div><div class="line">_.extend2(users, <span class="string">'(#2)-&gt;posts-&gt;(#3)'</span>, &#123; <span class="attr">body</span>: <span class="string">"하이3 수정함"</span>, <span class="attr">updated_at</span>: <span class="keyword">new</span> <span class="built_in">Date</span>() &#125;);</div><div class="line"><span class="built_in">console</span>.log(users[<span class="number">1</span>].posts[<span class="number">0</span>]);</div><div class="line"><span class="comment">// &#123;id: 3, body: "하이3 수정함", comments: Array[0], updated_at: Sun Mar 05 ... &#125;</span></div><div class="line"></div><div class="line">_.push(users, <span class="string">'(#2)-&gt;posts-&gt;(#3)-&gt;comments'</span>, &#123; <span class="attr">id</span>: <span class="number">6</span>, <span class="attr">body</span>: <span class="string">'코멘트6'</span> &#125;);</div><div class="line"><span class="built_in">console</span>.log(users[<span class="number">1</span>].posts[<span class="number">0</span>].comments[<span class="number">0</span>].body); <span class="comment">// 코멘트6</span></div></pre></td></tr></table></figure>
<h3 id="함수로-값-변경하기"><a href="#함수로-값-변경하기" class="headerlink" title="함수로 값 변경하기"></a>함수로 값 변경하기</h3><p>안쪽의 값 변경을 함수로도 할 수 있어 지원되지 않는 기능이 있어도 내가 원하는 기능으로 변경할 수 있습니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> users = [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">name</span>: <span class="string">'BJ'</span>,</div><div class="line">    <span class="attr">post_count</span>: <span class="number">3</span>,</div><div class="line">    <span class="attr">posts</span>: [</div><div class="line">      &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">body</span>: <span class="string">'하이'</span>, <span class="attr">comments</span>: [&#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">body</span>: <span class="string">'코멘트3'</span> &#125;] &#125;,</div><div class="line">      &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">body</span>: <span class="string">'하이2'</span>, <span class="attr">comments</span>: [&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">body</span>: <span class="string">'코멘트1'</span> &#125;, &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">body</span>: <span class="string">'코멘트2'</span> &#125;] &#125;,</div><div class="line">      &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">body</span>: <span class="string">'하이4'</span>, <span class="attr">comments</span>: [&#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">body</span>: <span class="string">'코멘트4'</span> &#125;, &#123; <span class="attr">id</span>: <span class="number">5</span>, <span class="attr">body</span>: <span class="string">'코멘트5'</span> &#125;] &#125;</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="attr">id</span>: <span class="number">2</span>,</div><div class="line">    <span class="attr">name</span>: <span class="string">'PJ'</span>,</div><div class="line">    <span class="attr">post_count</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">posts</span>: [</div><div class="line">      &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">body</span>: <span class="string">'하이3'</span>, <span class="attr">comments</span>: [] &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">];</div><div class="line"></div><div class="line">_.set(users, <span class="string">'(#1)-&gt;posts'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">posts</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> _.reject(posts, <span class="function"><span class="keyword">function</span>(<span class="params">post</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> post.comments.length &lt; <span class="number">2</span>;</div><div class="line">  &#125;);</div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log(_.sel(users, <span class="string">'(#1)-&gt;posts'</span>).length);  <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<h2 id="함수-스타일의-템플릿-함수"><a href="#함수-스타일의-템플릿-함수" class="headerlink" title="함수 스타일의 템플릿 함수"></a>함수 스타일의 템플릿 함수</h2><p>Partial.js는 함수 스타일의 템플릿 엔진으로 함수 실행, 코드 실행, 인자 선언, Jade 스타일 문법 지원, 일반 HTML 문법 지원, 비동기 제어 등의 기능을 지원합니다.</p>
<h3 id="Jade-스타일-문법-지원"><a href="#Jade-스타일-문법-지원" class="headerlink" title="Jade 스타일 문법 지원"></a>Jade 스타일 문법 지원</h3><p>Partial.js의 템플릿 함수 종류에는 인자를 여러 개 받아 사용할 수 있는 <code>_.template</code>, 인자를 <code>$</code>로 한 개만 받아 사용하는 <code>_.template$</code>, 배열을 받아 반복 시킨 문자열을 만드는 <code>_.template.each</code> 등이 있습니다. <code>_.template</code> 시리즈는 모두 Jade 스타일의 문법을 지원하며, 짧은 이름으로 <code>_.t</code>, <code>_.t$</code>, <code>_.teach</code>, <code>_.teach$</code>로 사용 가능합니다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">_.pipe(</div><div class="line">  _.template$(<span class="string">'\</span></div><div class="line">    .product_list\</div><div class="line">      ul\</div><div class="line">        li 티셔츠\</div><div class="line">        li 핸드폰 케이스\</div><div class="line">        li 쿠션\</div><div class="line">        li 담요'),</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">html</span>) </span>&#123;</div><div class="line">    $(<span class="string">'body'</span>).append(html);</div><div class="line">  &#125;)();</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 결과 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"product_list"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>티셔츠<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>핸드폰 케이스<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>쿠션<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>담요<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>ES5에서는 아직 멀티 라인이 지원되지 않기에 \ 를 사용합니다. 위 코드는 템플릿 엔진 Jade 스타일의 문법이며 CSS Selector와 비슷합니다. 지금은 Jade의 이름이 Pug로 변경되었습니다. 간결하게 HTML을 표현할 수 있습니다. 다음과 같은 문법들을 지원합니다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">_.pipe(</div><div class="line">  _.template$(<span class="string">'\</span></div><div class="line">    div[style="border: 1px solid #000; padding: 20px;"]\</div><div class="line">      #id1.class1.class2[class="class3 class4"] hi &lt;em&gt;ho&lt;/em&gt;\</div><div class="line">      .service\</div><div class="line">        a[href="http://www.marpple.com" target="_blank"] http://www.marpple.com\</div><div class="line">      br'),</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">html</span>) </span>&#123;</div><div class="line">    $(<span class="string">'body'</span>).append(html);</div><div class="line">  &#125;)();</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 결과 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"border: 1px solid #000; padding: 20px;"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"id1"</span> <span class="attr">class</span>=<span class="string">"class1 class2 class3 class4"</span>&gt;</span>hi <span class="tag">&lt;<span class="name">em</span>&gt;</span>ho<span class="tag">&lt;/<span class="name">em</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"service"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.marpple.com"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>http://www.marpple.com<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="데이터-치환"><a href="#데이터-치환" class="headerlink" title="데이터 치환"></a>데이터 치환</h3><p>Partial.js의 템플릿 함수들은 Handlebars나 Underscore.js의 템플릿 함수들처럼 함수를 리턴하는 함수입니다. 다음과 같은 방법으로 문자열 안에서 데이터를 치환할 수 있습니다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">_.go(</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">"Hanah"</span>, <span class="attr">age</span>: <span class="number">25</span> &#125;,</div><div class="line">  _.template$(<span class="string">'\</span></div><div class="line">    .user\</div><div class="line">      .name &#123;&#123;$.name&#125;&#125;\</div><div class="line">      .age &#123;&#123;$.age&#125;&#125;'),</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">html</span>) </span>&#123;</div><div class="line">    $(<span class="string">'body'</span>).append(html);</div><div class="line">  &#125;);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 결과 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"user"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"name"</span>&gt;</span>Hanah<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"age"</span>&gt;</span>25<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="일반-HTML-전용-string"><a href="#일반-HTML-전용-string" class="headerlink" title="일반 HTML 전용 _.string"></a>일반 HTML 전용 _.string</h3><p>일반 HTML만 사용할 때는 Jade 파싱 절차가 생략되는 <code>_.string</code>, <code>_.string$</code>, <code>_.seach</code>, <code>_.seach$</code> 등을 사용하는 것이 좋습니다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="xml"></span></div><div class="line">_.go(</div><div class="line">  &#123; name: "Dool", age: 25 &#125;,</div><div class="line">  _.string$('\</div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"user"</span>&gt;</span>\</div><div class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"name"</span>&gt;</span>&#123;&#123;$.name&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span>\</div><div class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"age"</span>&gt;</span>&#123;&#123;$.age&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span>\</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span>'),</div><div class="line">  function(html) &#123;</div><div class="line">    $('body').append(html);</div><div class="line">  &#125;);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 결과 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"user"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"name"</span>&gt;</span>Dool<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"age"</span>&gt;</span>25<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="escape"><a href="#escape" class="headerlink" title="escape"></a>escape</h3><p><code>{{}}</code>과 <code>{{{}}}</code>를 사용하여 출력 모드를 변경할 수 있습니다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="keyword">var</span> t1 = _.template(<span class="string">'html'</span>, <span class="string">'\</span></div><div class="line">  div\</div><div class="line">    &#123;&#123;html&#125;&#125; &#123;&#123;&#123;html&#125;&#125;&#125;');</div><div class="line"></div><div class="line">$(<span class="string">'body'</span>).append(t1(<span class="string">'&lt;h3&gt;하이&lt;/h3&gt;'</span>));</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 결과 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h3</span>&gt;</span>하이<span class="tag">&lt;/<span class="name">h3</span>&gt;</span> &amp;lt;h3&amp;gt;하이&amp;lt;/h3&amp;gt;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="코드-실행"><a href="#코드-실행" class="headerlink" title="코드 실행"></a>코드 실행</h3><p><code>{{}}</code>나 <code>{{{}}}</code>안에서는 자바스크립트 코드(표현식 expression)를 작성할 수 있습니다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="keyword">var</span> t2 = _.template(<span class="string">'a, b, bool'</span>, <span class="string">'\</span></div><div class="line">  div\</div><div class="line">    &#123;&#123; a + b &#125;&#125; &#123;&#123; bool ? "참" : "거짓" &#125;&#125;');</div><div class="line"></div><div class="line">$(<span class="string">'body'</span>).append(t2(<span class="number">10</span>, <span class="number">5</span>, <span class="literal">true</span>));</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 결과 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>15 참<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>함수를 실행할 수도 있습니다. 전역에 정의된 함수나, 직접 넘긴 함수나 메서드를 실행할 수 있습니다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> a + b;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> t3 = _.template(<span class="string">'a, b, sub, d'</span>, <span class="string">'\</span></div><div class="line">  div\</div><div class="line">    &#123;&#123; add(a, b) &#125;&#125;, &#123;&#123; sub(add(a, b), 7) &#125;&#125;, &#123;&#123; d.getFullYear() &#125;&#125;');</div><div class="line"></div><div class="line">$(<span class="string">'body'</span>).append(</div><div class="line">  t3(<span class="number">10</span>, <span class="number">5</span>, <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123; <span class="keyword">return</span> a - b &#125;, <span class="keyword">new</span> <span class="built_in">Date</span>()));</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 결과 --&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>15, 8, 2017<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>코드를 실행하는 방법이 한가지 더 있습니다. 템플릿 함수를 정의하는 과정에서 문자열과 함께 함수를 넘겨줄 수 있습니다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="keyword">var</span> t4 = _.template(<span class="string">'list'</span>, <span class="string">'\</span></div><div class="line">  ul\</div><div class="line">    li &#123;&#123;add(list[0], list[1])&#125;&#125;\</div><div class="line">    li\</div><div class="line">      &#123;&#123;_.map(list, ', <span class="function"><span class="keyword">function</span>(<span class="params">v</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> r = v * <span class="number">10</span>;</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">      &#125;, <span class="string">').join(", ")&#125;&#125;\</span></div><div class="line">    li\</div><div class="line">      &#123;&#123;_.reduce(list, ', <span class="function"><span class="keyword">function</span>(<span class="params">memo, v</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> memo + v;</div><div class="line">      &#125;,<span class="string">')&#125;&#125;'</span>);</div><div class="line"></div><div class="line">$(<span class="string">'body'</span>).append(</div><div class="line">  t4([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]));</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 결과 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>10, 20, 30, 40, 50<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>15<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure>
<p>위와 같이 코딩하면 두 줄 이상의 코드도 실행이 가능하고 중첩 따옴표 등의 문제로부터 자유로워집니다. 아무 함수나 실행 가능하고 아무 메서드나 실행 가능합니다. 전역에 선언된 함수나, 인자로 넘긴 함수나, 미리 익명 함수 등으로 선언한 함수도 사용이 가능하며, 클로저, 스코프 등의 특성도 모두 이용이 가능합니다. Handlebars 등은 Helper 등록이 까다롭고, 사용하기 불편한 편입니다. Helper 들의 중첩 활용도 지원하지 않고 그것을 해결하고자 한 오픈소스들도 잘 동작하지 않아 사용이 어렵습니다.</p>
<h3 id="teach"><a href="#teach" class="headerlink" title="_.teach"></a>_.teach</h3><p><code>_.teach</code>와 <code>_.seach</code>는 <code>_.template</code>, <code>_.string</code>의 <code>each</code> 버전입니다. 배열을 받아 반복하여 문자열을 합칩니다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="keyword">var</span> users = [</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">"Cojamm"</span>, <span class="attr">age</span>: <span class="number">32</span> &#125;,</div><div class="line">  &#123; <span class="attr">name</span>: <span class="string">"JIP"</span>, <span class="attr">age</span>: <span class="number">31</span> &#125;</div><div class="line">];</div><div class="line"></div><div class="line">_.go(users,</div><div class="line">  _.template(<span class="string">'users'</span>, <span class="string">'\</span></div><div class="line">    ul.users\</div><div class="line">      &#123;&#123;_.go(users, ', _.teach(<span class="string">'user'</span>, <span class="string">'\</span></div><div class="line">        li.user\</div><div class="line">          .name &#123;&#123;user.name&#125;&#125;\</div><div class="line">          .age &#123;&#123;user.age&#125;&#125;'), <span class="string">')&#125;&#125;'</span>),</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">html</span>) </span>&#123;</div><div class="line">    $(<span class="string">'body'</span>).append(html)</div><div class="line">  &#125;);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 결과 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"users"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"user"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"name"</span>&gt;</span>Cojamm<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"age"</span>&gt;</span>32<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"user"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"name"</span>&gt;</span>JIP<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"age"</span>&gt;</span>31<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="비동기-제어"><a href="#비동기-제어" class="headerlink" title="비동기 제어"></a>비동기 제어</h3><p><code>_.template</code>, <code>_.teach</code> 등의 템플릿 함수들은 Partial.js의 비동기 제어 콘셉트를 그대로 지원합니다. 중간에 비동기 상황을 만나면 결과를 기다린 후 문자열을 조합합니다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">_.go(<span class="literal">null</span>,</div><div class="line">  _.template$(<span class="string">'\</span></div><div class="line">    ul.users\</div><div class="line">      &#123;&#123;_.go($.get("/users"), ', _.teach(<span class="string">'user'</span>, <span class="string">'\</span></div><div class="line">        li.user\</div><div class="line">          .name &#123;&#123;user.name&#125;&#125;\</div><div class="line">          .age &#123;&#123;user.age&#125;&#125;'), <span class="string">')&#125;&#125;'</span>),</div><div class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">html</span>) </span>&#123;</div><div class="line">    $(<span class="string">'body'</span>).append(html)</div><div class="line">  &#125;);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 약 1초 쯤 뒤 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"users"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"user"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"name"</span>&gt;</span>Cojamm<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"age"</span>&gt;</span>32<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"user"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"name"</span>&gt;</span>JIP<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"age"</span>&gt;</span>31<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="Underscore"><a href="#Underscore" class="headerlink" title="Underscore"></a>Underscore</h2><p>Partial.js의 15% 정도의 코드는 Underscore.js에서 그대로 가져왔습니다. 우리는 Underscore.js를 만든 개발자들의 코드와 글에서 많은 것을 배웠습니다.</p>
<h5 id="관련-링크"><a href="#관련-링크" class="headerlink" title="관련 링크:"></a>관련 링크:</h5><ul>
<li><a href="http://underscorejs.org" target="_blank" rel="external">http://underscorejs.org</a></li>
<li><a href="http://documentcloud.github.io/underscore-contrib" target="_blank" rel="external">http://documentcloud.github.io/underscore-contrib</a></li>
<li><a href="https://github.com/fogus/lemonad" target="_blank" rel="external">https://github.com/fogus/lemonad</a></li>
</ul>

    </div>
  </div>
</article>



      </div>
    </div>
    <nav id="mobile-nav">
  
    <a href="/partial.js/" class="mobile-nav-link">About</a>
  
    <a href="/partial.js/docs" class="mobile-nav-link">Docs</a>
  
    <a href="https://github.com/marpple/partial.js" class="mobile-nav-link">Github</a>
  
    <a href="https://github.com/functionandjs/book" class="mobile-nav-link">Book</a>
  
    <a href="https://marpple.github.io/partial.py" class="mobile-nav-link">Partial.py</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/partial.js/fancybox/jquery.fancybox.css">
  <script src="/partial.js/fancybox/jquery.fancybox.pack.js"></script>

<script src="/partial.js/js/partial.js"></script>
<script src="/partial.js/js/script.js"></script>

  </div>
</body>
</html>